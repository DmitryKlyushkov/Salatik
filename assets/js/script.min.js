function testWebP(callback){var webP=new Image;webP.onload=webP.onerror=function(){callback(2==webP.height)},webP.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}testWebP((function(support){1==support?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")}));var $window=$(window),$slider=$(".slider"),$dropDown=$(".dropdown"),$loginDropDown=$(".login-dropdown__container"),$loggedinDropDown=$(".header__login-container--loggedin i"),$loginContainer=$(".login__container"),$searchInput=$(".header__search-input"),$mobileMenu=$(".mobile-menu"),$afterDD=$(".dropdown:after"),$arrow=$(".scroll-top"),$ingredient=$(".ingredients__ingredient"),$chem=$(".calories__chem"),$checkbox=$(".checkbox");$placeholder=$(".recepies-profile__placeholder"),$select=$(".recepies-profile__select"),$profilePhoto=$(".recepies-profile__photo"),$login=$("#form-reg__login"),$name=$("#form-reg__name"),$password=$("#form-reg__password"),$password_re=$("#form-reg__password_re"),$formBtn=$("#form-reg__btn"),viewPortHeight=$(window).height();var menuItemHasChildren=$(".has-children > a");menuItemHasChildren.append('<i class="icon-arrow-down">'),$window.on("scroll",(function(){let windowOffset;$window.scrollTop()>=viewPortHeight?$arrow.css({visibility:"visible",opacity:"1"}):$arrow.css({visibility:"hidden",opacity:"0"})})),$arrow.on("click",(function(e){if(""!==this.hash){e.preventDefault();const hash=this.hash;$("html, body").animate({scrollTop:$(hash).offset().top},800)}})),$(window).on("DOMContentLoaded",(function(){let $searchBar=$(".header__search-bar"),$searchPlaceholder=$(".header__search-input"),searchBarWidth;$searchBar.width()<=249?$searchPlaceholder.attr("placeholder","Поиск"):$searchPlaceholder.attr("placeholder","Поиск рецептов")})),$window.on("resize",(function(){let wWidth=$window.width(),$searchPlaceholder=$(".header__search-input");wWidth<=1135?$searchPlaceholder.attr("placeholder","Поиск"):$searchPlaceholder.attr("placeholder","Поиск рецептов")})),$(".menu-icon__container").on("click",(function(){$(this).toggleClass("change"),$mobileMenu.toggleClass("active")}));var mobileMenuLink=$(".mobile-menu--bot li.dropdown > a");function setPlaceholder(){$placeholder.text($select.find("option:selected").attr("value"))}mobileMenuLink.after('<i class="icon-arrow-down">'),$dropDown.each((function(){$(this).on("click",(function(){$(this).toggleClass("active");let container=$(this).next(".dropdown__container"),container2=$(this).find(".dropdown__container");"none"===container.css("display")?container.css("display","block"):container.css("display","none"),"none"===container2.css("display")?container2.css("display","block"):container2.css("display","none")}))})),$loggedinDropDown.on("click",(function(){$(this).toggleClass("active");let container=$(this).next(".login__container");"none"===container.css("display")?container.css("display","block"):container.css("display","none")})),$(document).on("mouseup",(function(e){0===$loginDropDown.has(e.target).length?$loginDropDown.hide():0===$searchInput.has(e.target).length&&$searchInput.hide(),0===$loginContainer.has(e.target).length&&e.target!=$loggedinDropDown[0]&&$loginContainer.css("display","none")})),$slider.slick({arrows:!0,nextArrow:'<button type="button" class="slick-next"><i class="icon-arrow"></i></button>',prevArrow:'<button type="button" class="slick-prev"><i class="icon-arrow"></i></button>',dots:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1,speed:300,infinite:!0}),baguetteBox.run(".gallery__card",{captions:!0,buttons:!1,fullScreen:!1,noScrollbars:!0,bodyClass:"baguetteBox-open",titleTag:!1,async:!1,preload:2,animation:"slideIn",overlayBackgroundColor:"rgba(0,0,0,.9)"}),$.each($checkbox,(function(index,val){let input;1==$(this).find("input").prop("checked")&&$(this).addClass("active")})),$checkbox.on("click",(function(event){let input=$(this).find("input");return $(this).hasClass("active")?input.prop("checked",!1):input.prop("checked",!0),$(this).toggleClass("active"),!1})),function(){let originalPositions=[],daElements=document.querySelectorAll("[data-da]"),daElementsArray=[],daMatchMedia=[];if(daElements.length>0){let number=0;for(let index=0;index<daElements.length;index++){const daElement=daElements[index],daMove=daElement.getAttribute("data-da");if(""!=daMove){const daArray=daMove.split(","),daPlace=daArray[1]?daArray[1].trim():"last",daBreakpoint=daArray[2]?daArray[2].trim():"767",daType="min"===daArray[3]?daArray[3].trim():"max",daDestination=document.querySelector("."+daArray[0].trim());daArray.length>0&&daDestination&&(daElement.setAttribute("data-da-index",number),originalPositions[number]={parent:daElement.parentNode,index:indexInParent(daElement)},daElementsArray[number]={element:daElement,destination:document.querySelector("."+daArray[0].trim()),place:daPlace,breakpoint:daBreakpoint,type:daType},number++)}}dynamicAdaptSort(daElementsArray);for(let index=0;index<daElementsArray.length;index++){const el=daElementsArray[index],daBreakpoint=el.breakpoint,daType=el.type;daMatchMedia.push(window.matchMedia("("+daType+"-width: "+daBreakpoint+"px)")),daMatchMedia[index].addListener(dynamicAdapt)}}function dynamicAdapt(e){for(let index=0;index<daElementsArray.length;index++){const el=daElementsArray[index],daElement=el.element,daDestination=el.destination,daPlace=el.place,daBreakpoint=el.breakpoint,daClassname="_dynamic_adapt_"+daBreakpoint;if(daMatchMedia[index].matches){if(!daElement.classList.contains(daClassname)){let actualIndex=indexOfElements(daDestination)[daPlace];"first"===daPlace?actualIndex=indexOfElements(daDestination)[0]:"last"===daPlace&&(actualIndex=indexOfElements(daDestination)[indexOfElements(daDestination).length]),daDestination.insertBefore(daElement,daDestination.children[actualIndex]),daElement.classList.add(daClassname)}}else daElement.classList.contains(daClassname)&&(dynamicAdaptBack(daElement),daElement.classList.remove(daClassname))}}function dynamicAdaptBack(el){const daIndex=el.getAttribute("data-da-index"),originalPlace=originalPositions[daIndex],parentPlace=originalPlace.parent,indexPlace=originalPlace.index,actualIndex=indexOfElements(parentPlace,!0)[indexPlace];parentPlace.insertBefore(el,parentPlace.children[actualIndex])}function indexInParent(el){var children;return Array.prototype.slice.call(el.parentNode.children).indexOf(el)}function indexOfElements(parent,back){const children=parent.children,childrenArray=[];for(let i=0;i<children.length;i++){const childrenElement=children[i];back?childrenArray.push(i):null==childrenElement.getAttribute("data-da")&&childrenArray.push(i)}return childrenArray}function dynamicAdaptSort(arr){arr.sort((function(a,b){return a.breakpoint>b.breakpoint?-1:1})),arr.sort((function(a,b){return a.place>b.place?1:-1}))}dynamicAdapt()}(),$select.on("change",setPlaceholder);var formImage=document.getElementById("formImage"),formPreview=document.querySelectorAll(".file__preview");function uploadFile(file){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(file.type))return alert("Разрешены только изображения."),void(formImage.value="");if(file.size>2097152)alert("Файл должен быть менее 2МБ.");else{var reader=new FileReader;reader.onload=function(e){for(let i=0;i<formPreview.length;i++)if(""===formPreview[i].innerHTML)return void(formPreview[i].innerHTML=`<img src="${e.target.result}" alt="Фото">`)},reader.onerror=function(e){alert("Ошибка")},reader.readAsDataURL(file)}}null!=formImage&&formImage.addEventListener("change",e=>{uploadFile(formImage.files[0])});var profileDownload=document.getElementById("profile__download"),avatarPreview=document.querySelectorAll(".profile__avatar"),$avatarForm=$("#avatar-form");function uploadAvatar(file){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(file.type))return alert("Разрешены только изображения."),void(profileDownload.value="");if(file.size>2097152)alert("Файл должен быть менее 2МБ.");else{var reader=new FileReader;reader.onload=function(e){for(let i=0;i<avatarPreview.length;i++)return""===avatarPreview[i].innerHTML?void(avatarPreview[i].innerHTML=`<img src="${e.target.result}" alt="Фото">`):(avatarPreview[i].innerHTML="",void(avatarPreview[i].innerHTML=`<img src="${e.target.result}" alt="Фото">`))},reader.onerror=function(e){alert("Ошибка")},reader.readAsDataURL(file)}}function nameValidate(block){let val;if(!block.val().match(/^[a-zA-Za-яА-Я]+$/iu))return block.removeClass("valid").addClass("invalid"),void block[0].setCustomValidity("Разрешены только латинские и кириллические символы");block.removeClass("invalid").addClass("valid"),block[0].setCustomValidity("")}function loginValidate(block){let val;if(!block.val().match(/^[a-zA-Z0-9]+$/iu))return block.removeClass("valid").addClass("invalid"),void block[0].setCustomValidity("Разрешены только латинские символы и цифры");block.removeClass("invalid").addClass("valid"),block[0].setCustomValidity("")}function passwordSimilarity(block){let val=$password.val(),val_re;return block.val()===val?(block.removeClass("invalid").addClass("valid"),void block[0].setCustomValidity("")):(block.removeClass("valid").addClass("invalid"),void block[0].setCustomValidity("Пароли не совпадают"))}function passwordValidate(block){let val=block.val();return val.length>7?(block.removeClass("invalid").addClass("valid"),block[0].setCustomValidity(""),val.match(/^[a-zA-Z0-9]+$/iu)?(block.removeClass("invalid").addClass("valid"),void block[0].setCustomValidity("")):(block.removeClass("valid").addClass("invalid"),void block[0].setCustomValidity("Разрешены только латинские символы  и цифры"))):(block.removeClass("valid").addClass("invalid"),void block[0].setCustomValidity("Пароль слишком короткий"))}$avatarForm.on("submit",(function(e){e.preventDefault();var avatarForm=$(this),fileData=avatarForm.find(".profile__download")[0].files[0],avatarajaxurl=avatarForm.data("url"),formData=new FormData;formData.append("file",fileData),formData.append("action","salatik_save_user_avatar"),$.ajax({url:avatarajaxurl,type:"POST",contentType:!1,processData:!1,data:formData,success:function(response){console.log(response)},error:function(response){console.log(response)}})})),null!=profileDownload&&profileDownload.addEventListener("change",()=>{uploadAvatar(profileDownload.files[0])}),$profilePhoto.on("click",(function(){$.each($profilePhoto,(function(){$(this).hasClass("active")&&$(this).removeClass("active")})),$(this).addClass("active")})),$formBtn.on("click",(function(){loginValidate($login),nameValidate($name),passwordSimilarity($password_re),passwordValidate($password)}));const popupLinks=document.querySelectorAll(".popup-link"),body=document.querySelector("body"),lockPadding=document.querySelectorAll(".lock-padding");let unlock=!0;const timeout=800;if(popupLinks.length>0)for(let index=0;index<popupLinks.length;index++){const popupLink=popupLinks[index];popupLink.addEventListener("click",(function(e){const popupName=popupLink.getAttribute("href").replace("#",""),currentPopup=document.getElementById(popupName);popupOpen(currentPopup),e.preventDefault()}))}const popupCloseIcon=document.querySelectorAll(".close-popup");if(popupCloseIcon.length>0)for(let index=0;index<popupCloseIcon.length;index++){const el=popupCloseIcon[index];el.addEventListener("click",(function(e){popupClose(el.closest(".popup")),e.preventDefault()}))}function popupOpen(currentPopup){if(currentPopup&&unlock){const popupActive=document.querySelector(".popup.open");popupActive?popupClose(popupActive,!1):bodyLock(),currentPopup.classList.add("open"),currentPopup.addEventListener("click",(function(e){e.target.closest(".popup__content")||popupClose(e.target.closest(".popup"))}))}}function popupClose(popupActive,doUnclock=!0){unlock&&(popupActive.classList.remove("open"),doUnclock&&bodyUnlock())}function bodyLock(){const lockPaddingValue=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(lockPadding.length>0)for(let index=0;index<lockPadding.length;index++){const el=lockPadding[index];el.getElementsByClassName.paddingRight=lockPaddingValue}body.style.paddingRight=lockPaddingValue,body.classList.add("lock"),unlock=!1,setTimeout((function(){unlock=!0}),800)}function bodyUnlock(){setTimeout((function(){if(lockPadding.length>0)for(let index=0;index<lockPadding.length;index++){const el=lockPadding[index];el.style.paddingRight="0px"}body.style.paddingRight="0px",body.classList.remove("lock")}),800),unlock=!1,setTimeout((function(){unlock=!0}),800)}document.addEventListener("keydown",(function(e){if(27===e.which){const popupActive=document.querySelector(".popup.open");popupCLose(popupActive)}})),Element.prototype.closest||(Element.prototype.closest=function(css){for(var node=this;node;){if(node.matches(css))return node;node=node.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);var $profileForm=$("#profile-form");$profileForm.on("submit",(function(e){e.preventDefault();var form=$(this),file_data=form.find("#formImage")[0].files[0],category=form.find("#category").val(),title=form.find("#profile-form__name").val(),content=form.find("#profile-form__text").val();ingredients=form.find("#profile-form__ingredients").val(),calories=form.find("#profile-form__calories").val(),time=form.find("#profile-form__time").val();var ajaxurl=form.data("url"),form_data=new FormData;form_data.append("file",file_data),form_data.append("category",category),form_data.append("title",title),form_data.append("content",content),form_data.append("ingredients",ingredients),form_data.append("calories",calories),form_data.append("time",time),form_data.append("action","salatik_save_user_recipe"),$.ajax({url:ajaxurl,type:"POST",contentType:!1,processData:!1,data:form_data,success:function(response){setTimeout((function(){form.trigger("reset")}),1e3)},error:function(response){console.log(response)}})})),$(".main-panel__savetext--nolog").on("click",(function(e){e.preventDefault(),$(this).html("Войдите")})),Inputmask({regex:String.raw`([a-zA-Zа-яА-Я]+ ([a-zA-Zа-яА-Я]+ )*\([^()]+\), )+`}).mask("#profile-form__ingredients"),Inputmask({regex:String.raw`Белки \(\d+(\.?\d+)?г\), Жиры \(\d+(\.?\d+)?г\), Углеводы \(\d+(\.?\d+)?г\), Калорийность \(\d+(\.?\d+)?Ккал\)`}).mask("#profile-form__calories"),$("#profile-form__time").inputmask("9{1,} минут(ы)");